# unique first column
sectors[!duplicated(1), ]
sectors <- result$industry[!grepl("Other", result$industry)]
# unique first column
sectors[!duplicated(1), ]
sectors <- result$industry[!grepl("Other", result$industry)]
# unique first column
sectors[!duplicated(1), ]
sectors <- as.data.frame(sectors)
# unique first column
sectors[!duplicated(1), ]
# unique first column
sectors <- sectors[!duplicated(1), ]
sectors <- as.data.frame(sectors)
View(sectors)
sectors <- result$industry[!grepl("Other", result$industry)]
# unique first column
sectors <- unique( sectors[ ,1] )
sectors <- result$industry[!grepl("Other", result$industry)]
sectors <- as.data.frame(sectors)
# unique first column
sectors <- unique( sectors[ ,1] )
sectors <- as.data.frame(sectors)
qplot(result, sectors)
qplot(result$county, sectors)
qplot(result$county, sectors[[1]])
sectors[[1]]
result$county
county <- unique( sectors[ ,1] )
View(result)
county <- unique( result[ ,5] )
# unique first column
sectors <- unique( sectors[ ,1] )
county <- unique( result[ ,5] )
sectors <- as.data.frame(sectors)
qplot(county, sectors[[1]])
county <- as.data.frame(county)
qplot(county[[1]], sectors[[1]])
# unique first column
result$newsec <- unique( sectors[ ,1] )
histogram(result$county, sectors[[1]])
hist(result$county, sectors[[1]])
hist(sum(result$company_id), result$county)
city <- unique( result[ ,5] )
city <- as.data.frame(city)
View(city)
city <- unique( result[ ,5] )
result[ ,5]
city <- result$town
View(result)
city <- result$town
city <- unique( city[[1]])
city <- as.data.frame(city)
View(city)
city <- result$town
city <- as.data.frame(city)
city <- unique( city[[1]])
sectors <- unique( city[ ,1] )
city <- result$town
sectors <- unique( city[ ,1] )
city <- result$town
city <- as.data.frame(city)
sectors <- unique( city[ ,1] )
city <- result$town
city <- as.data.frame(city)
View(city)
hist(result$town, unique( result$industry[!grepl("Other", result$industry) ))
result$industry = sectors
result$industry == sectors
result[result$industry == sectors]
result[,result$industry == sectors]
query <- "SELECT DISTINCT industry FROM company"
result <- dbGetQuery(con, query)
result <- as.data.frame(result)
typeof(result)
View(result)
query <- "SELECT * FROM company"
industry <- "SELECT DISTINCT industry FROM company"
result <- dbGetQuery(con, query)
industry <- dbGetQuery(con, industry)
str(result)
result <- as.data.frame(result)
View(industry)
View(industry)
t <- paste("select * from company where industry = ", industry, ";",sep="")
t <- dbGetQuery(con, t)
con = dbConnect(MySQL(), user='root', password='root', dbname='jobWizard', host='localhost',unix.sock="/Applications/MAMP/tmp/mysql/mysql.sock")
dbListTables(con)
t <- paste("select * from company where industry = ", industry, ";",sep="")
t <- dbGetQuery(con, t)
t
t <- paste("select * from company where industry = ", c("Other"), ";",sep="")
t <- dbGetQuery(con, t)
query <- "SELECT * FROM company"
industry <- "SELECT DISTINCT industry FROM company"
t <- paste("select * from company where industry = ", industry, ";",sep="")
t <- dbGetQuery(con, t)
t
t <- paste("select * from SELECT DISTINCT industry FROM company")
t <- "select * from SELECT DISTINCT industry FROM company"
t
t <- dbGetQuery(con, t)
t <- "select * from (SELECT DISTINCT industry FROM company)"
t
result <- dbGetQuery(con, query)
industry <- dbGetQuery(con, industry)
t <- dbGetQuery(con, t)
industry-company <- "select * from company where `industry` in (SELECT DISTINCT `industry` FROM company)"
industryCompany <- "select * from company where `industry` in (SELECT DISTINCT `industry` FROM company)"
industryCompany <- dbGetQuery(con, industryCompany)
industryCompany <- "select * from company where `industry` in (SELECT DISTINCT `industry` FROM company)"
industryCompany <- "select * from company where `industry` in (SELECT DISTINCT `industry` FROM company where `industry != `Other`)"
industryCompany <- dbGetQuery(con, industryCompany)
industryCompany <- dbGetQuery(con, industryCompany)
industryCompany <- "select * from company where `industry` in (SELECT DISTINCT `industry` FROM company WHERE industry !='Other')"
industryCompany <- "select * from company where `industry` in (SELECT DISTINCT `industry` FROM company WHERE industry !='Other');"
industryCompany <- dbGetQuery(con, industryCompany)
View(industryCompany)
#sectors <- result$industry[!grepl("Other", result$industry)]
#sectors <- as.data.frame(sectors)
# unique first column
#sectors <- unique( sectors[ ,1] )
#sectors <- as.data.frame(sectors)
hist(result$industry)
#sectors <- result$industry[!grepl("Other", result$industry)]
#sectors <- as.data.frame(sectors)
# unique first column
#sectors <- unique( sectors[ ,1] )
#sectors <- as.data.frame(sectors)
hist(sum(result)
#sectors <- result$industry[!grepl("Other", result$industry)]
#sectors <- as.data.frame(sectors)
# unique first column
#sectors <- unique( sectors[ ,1] )
#sectors <- as.data.frame(sectors)
hist(sum(result))
#sectors <- result$industry[!grepl("Other", result$industry)]
#sectors <- as.data.frame(sectors)
# unique first column
#sectors <- unique( sectors[ ,1] )
#sectors <- as.data.frame(sectors)
hist(sum(result))
industryCompany <- "select * from company where `industry` in (SELECT DISTINCT `industry` FROM company WHERE industry !='Other');"
industryCompany <- dbGetQuery(con, industryCompany)
industryCompany <- as.data.frame(industryCompany)
View(industryCompany)
#sectors <- result$industry[!grepl("Other", result$industry)]
#sectors <- as.data.frame(sectors)
# unique first column
#sectors <- unique( sectors[ ,1] )
#sectors <- as.data.frame(sectors)
hist(sum(result$company_id), result$industry)
#sectors <- result$industry[!grepl("Other", result$industry)]
#sectors <- as.data.frame(sectors)
# unique first column
#sectors <- unique( sectors[ ,1] )
#sectors <- as.data.frame(sectors)
qplot(sum(result$company_id), result$industry)
#sectors <- result$industry[!grepl("Other", result$industry)]
#sectors <- as.data.frame(sectors)
# unique first column
#sectors <- unique( sectors[ ,1] )
#sectors <- as.data.frame(sectors)
qplot(result$industry,sum(result$company_id))
#sectors <- result$industry[!grepl("Other", result$industry)]
#sectors <- as.data.frame(sectors)
# unique first column
#sectors <- unique( sectors[ ,1] )
#sectors <- as.data.frame(sectors)
pairs.panels(result)
r <- industryCompany
dbWriteTable(con, "R",r,overwrite=TRUE, append=FALSE)
t
doc[[2]]
library("pdftools")
library("stringr")
library("tm")
#download.file("https://www.gov.uk/government/uploads/system/uploads/attachment_data/file/682406/2018-02-19_Tier_2_5_Register_of_Sponsors.pdf","./2018-02-19_Tier_2_5_Register_of_Sponsors.pdf")
rawText <- pdf_text("./2018-02-19_Tier_2_5_Register_of_Sponsors.pdf")
doc <- strsplit(rawText, "\n")
head(splitedByLineText)
header_row <- grep("^No. of Sponsors on Register Licensed under Tiers 2 and 5:", doc[[1]])
header_row
doc[[1]]
#header removal
doc[[1]] <- doc[[1]][(header_row + 1):length(doc[[1]])]
head(doc)
tail(doc)
length(doc)
#footer removal
footer_row_1 <- grep("Summary", doc[[1909]])
footer_row_2 <- grep("Total Number of Sponsors registered under Tiers 2 and 5",doc[[1909]])
footer_row_1
setwd("/Applications/MAMP/htdocs/Dissertation")
library("pdftools")
library("stringr")
library("tm")
#cleaning data
company_house <- read.csv("Company_House/companyData.csv", header=T)
#download.file("https://www.gov.uk/government/uploads/system/uploads/attachment_data/file/682406/2018-02-19_Tier_2_5_Register_of_Sponsors.pdf","./2018-02-19_Tier_2_5_Register_of_Sponsors.pdf")
rawText <- pdf_text("./2018-02-19_Tier_2_5_Register_of_Sponsors.pdf")
doc <- strsplit(rawText, "\n")
head(splitedByLineText)
header_row <- grep("^No. of Sponsors on Register Licensed under Tiers 2 and 5:", doc[[1]])
header_row
doc[[1]]
#header removal
doc[[1]] <- doc[[1]][(header_row + 1):length(doc[[1]])]
head(doc)
tail(doc)
length(doc)
#footer removal
footer_row_1 <- grep("Summary", doc[[1909]])
footer_row_2 <- grep("Total Number of Sponsors registered under Tiers 2 and 5",doc[[1909]])
footer_row_1
footer_row_2
doc[[1909]] <- doc[[1909]][-c(footer_row_1:footer_row_2)]
head(doc)
tail(doc)
length(doc[[1]])
tier2 <- 0
tier2 <- data.frame(tier2)
for (i in 1:length(doc)){
for (j in 1:length(doc[[i]]))
{
x <- c(x,strsplit(doc[[i]][j], "   ")[[1]][1])
}
}
for (i in 1:length(doc)){
for (j in 1:length(doc[[i]]))
{
tier2 <- c(x,strsplit(doc[[i]][j], "   ")[[1]][1])
}
}
for (i in 1:length(doc)){
for (j in 1:length(doc[[i]]))
{
tier2 <- c(tier2,strsplit(doc[[i]][j], "   ")[[1]][1])
}
}
length(tier2)
length(tier2[[1]])
length(tier2[[1]][1])
tier2[[1]][1]
tier2[[1]]
tier2[[2]]
tier2[[1]]
tier2[[8]]
tier2[[0]]
tier2[[1]]
tier2[[1]][0]
doc[[2]]
library(dplyr)
library("dplyr")
tier2
tier2[[2]]
tier2[[3]]
grep("", tier2[[3]])
tier2[[2]]
tier2[[3]]
grep("   ", tier2[[3]])
grep(" ", tier2[[3]])
grep(" ", tier2[[3]][1])
tier2[[3]][1]
tier2[[3]]
for (i in 1:length(teri2)){
print(tier2[[i]])
}
for (i in 1:length(teri2)){
print(tier2[[i]])
}
for (i in 1:length(teri2)){
tier2
}
for (i in 1:length(teri2)){
print(tier2[[i]])
}
for (i in 1:length(tier2)){
print(tier2[[i]])
}
tier2[[2]]
tier[[2]]
tier[[2]]
tier2[[2]]
str_replace(tier2[[2]], "  Organisation Name", "")
tier2[[2]]
doc[[2]]
doc[[3]]
doc[[6]]
doc[[8]]
x[[2]]
tier2[[2]]
gsub("  Organisation Name", tier2[[2]])
gsub("  Organisation Name","", tier2[[2]])
tier2[[2]]
grep("  Organisation Name", tier2[[2]])
gsub("  Organisation Name","", tier2[[2]])
tier2[[2]]
grep("  Organisation Name", tier2[[2]])
grep("  Organisation Name", tier2[[3]])
grep("  Organisation Name", tier2[[4]])
grep("  Organisation Name", tier2[[2]])
str_detect(tier2[[2]], "  Organisation Name")
(str_detect(tier2[[2]], " ")
str_detect(tier2[[2]], " "
str_detect(tier2[[2]], " ")
tier2[[2]]
string <- c("sad","sads","asda")
string
string <- c("sad")
string
grep("\\b \\b",string)
grep("\\bsad\\b",string)
string <- c("sada")
string
grep("\\bsad\\b",string)
grep("^bsad\\b",string)
if((str_detect(tier2[[2]], "  Organisation Name")) || (str_detect(tier2[[2]], " ") )
grep("^bsad\\b",string)
grep("^bsad\\b",string)
str_detect(tier2[[2]], "\\b \\b")
tier2
tier2[[2]]
grep("bsad\\b",tier2[[2]])
grep("\\bsad\\b",tier2[[2]])
str_detect(tier2[[2]], "\\b \\b")
grep("\\b \\b",tier2[[2]])
str_detect(tier2[[2]], "\\b \\b")
grep("^ $",tier2[[2]])
string <- c(" ")
string
grep("^ $",string)
str_detect(tier2[[2]], "^ $")
str_detect(string, "^ $")
grep("page",tier2[[1]])
grep("page",tier2[[2]])
tier2[[2]]
tier2[[3]]
tier2
tier2[[]]
tier2[1
tier2[1]
tier2[[1]]
View(tier2)
tier2[[73]]
if((str_detect(tier2[[2]], "  Organisation Name")) || (str_detect(tier2[[2]], "^ $"))  ){
tier2[[2]] <- NULL
}
tier2[[2]]
tier2[[2]]
View(tier2)
View(tier2)
if((str_detect(tier2[[2]], "  Organisation Name")) || (str_detect(tier2[[2]], "^ $")) || (str_detect(tier2[[0]], "^0$")) ){
tier2[[0]] <- NULL
}
tier2[[1]]
if((str_detect(tier2[[2]], "  Organisation Name")) || (str_detect(tier2[[2]], "^ $")) || (str_detect(tier2[[1]], "^0$")) ){
tier2[[1]] <- NULL
}
tier2[[1]]
for (i in 1:length(Tier2)){
if((str_detect(tier2[[i]], "  Organisation Name")) || (str_detect(tier2[[i]], "^ $")) || (str_detect(tier2[[i]], "^0$")) ){
tier2[[i]] <- NULL
}
}
for (i in 1:length(tier2)){
if((str_detect(tier2[[i]], "  Organisation Name")) || (str_detect(tier2[[i]], "^ $")) || (str_detect(tier2[[i]], "^0$")) ){
tier2[[i]] <- NULL
}
}
for (i in 1:length(tier2)){
if((str_detect(tier2[[i]], "  Organisation Name")) || (str_detect(tier2[[i]], "^ $")) || (str_detect(tier2[[i]], "^0$")) ){
tier2[[i]][i] <- NULL
}
}
tier2
View(tier2)
View(tier2)
tier2[[1]]
tier2[[21]]
for (i in 1:length(tier2)){
if((str_detect(tier2[[i]], "  Organisation Name")) || (str_detect(tier2[[i]], "^ $")) || (str_detect(tier2[[i]], "^0$")) || (str_detect(tier2[[i]], "^$")) ){
tier2[[i]][i] <- NULL
}
}
tier2[[15]]
tier2[[14]]
tier2[[1]](str_detect(tier2[[2]][14], ""))
(str_detect(tier2[[2]][14], ""))
str_detect(tier2[[2]][14], "")
str_detect(tier2[[2]][14], " ")
tier2[[2]][14]
tier2 <- 0
tier2 <- data.frame(tier2)
for (i in 1:length(doc)){
for (j in 1:length(doc[[i]]))
{
tier2 <- c(tier2,strsplit(doc[[i]][j], "   ")[[1]][1])
}
}
tier3[[1]][1] <- tier2[[1]][1]
tier3 <- 0
tier3[[1]][1] <- tier2[[1]][1]
tier3[[1]][1] <- NULL
tier3[[1]] <- NULL
tier3
tier3[[1]][1] <- tier2[[1]][1]
tier2[[1]][1]
tier2[[1]][2]
tier2[[1]][3]
View(tier2)
tier2[[1]][2]
tier2
tier3
tier3 <- tier2
tier3
tier3[[1]][2]
tier3[[1]][1]
tier3[[1]]
tier3[[2]]
tier3[[2]][1]
tier3[[2]][1] <- NULL
tier3[[2]] <- NULL
tier3[[2]]
for (i in 1:length(tier2)){
if((str_detect(tier2[[i]], "  Organisation Name")) || (str_detect(tier2[[i]], "^ $")) || (str_detect(tier2[[i]], "^0$")) ){
tier2[[i]][i] <- NULL
}
}
for (i in 1:length(tier2)){
if((str_detect(tier2[[i]], "  Organisation Name")) || (str_detect(tier2[[i]], "^ $")) || (str_detect(tier2[[i]], "^0$")) ){
tier2[[i]] <- NULL
}
}
tier2 <- tier3
for (i in 1:length(tier3)){
if((str_detect(tier2[[i]], "  Organisation Name")) || (str_detect(tier2[[i]], "^ $")) || (str_detect(tier2[[i]], "^0$")) ){
tier2[[i]] <- NULL
}
}
tier3 <- tier2
View(tier2)
tier2[[2]]
tier2[[2]][2]
str_detect(tier2[[2]][2], "NA")
str_detect(tier2[[2]][2], NA)
any(is.na(tier2))
any(is.na(tier2[[1]]))
any(is.na(tier2[[2]]))
View(tier2)
tier2[[2]]
any(is.na(tier2))
tier2
head(tier2)
tier2[[1]]
tier2[[2]]
is.na(tier2[[2]])
is.empty(tier2[[2]])
str_detect(tier2[[2]], "^$"))
str_detect(tier2[[2]], "^$")
(tier2[[2]])
for (i in 1:length(tier2)){
if((str_detect(tier2[[i]], "  Organisation Name")) || (str_detect(tier2[[i]], "^ $")) || (str_detect(tier2[[i]], "^0$")) || str_detect(tier2[[i]], "^$")){
tier2[[i]] <- NULL
}
}
View(tier2)
tier2[[2]]
for (i in 1:length(tier2)){
if((str_detect(tier2[[i]], "  Organisation Name")) || (str_detect(tier2[[i]], "^ $")) || (str_detect(tier2[[i]], "^0$")) || str_detect(tier2[[i]], "^$")){
tier2[[i]] <- NULL
}
}
for (i in 1:length(tier2)){
if((str_detect(tier2[[i]], "  Organisation Name")) || (str_detect(tier2[[i]], "^ $")) || (str_detect(tier2[[i]], "^0$")) || (str_detect(tier2[[i]], "^$")) ){
tier2[[i]] <- NULL
}
}
for (i in 1:length(tier2)){
if((str_detect(tier2[[i]], "  Organisation Name")) || (str_detect(tier2[[i]], "^ $")) || (str_detect(tier2[[i]], "^0$")) || (str_detect(tier2[[i]], "^$")) ){
tier2[[i]] <- NULL
}
}
for (i in 1:length(tier2)){
if((str_detect(tier2[[i]], "  Organisation Name")) || (str_detect(tier2[[i]], "^ $")) || (str_detect(tier2[[i]], "^0$")) || (str_detect(tier2[[i]], "^$")) ){
tier2[[i]] <- NULL
}
}
print(hi)
for (i in 1:length(tier2)){
if((str_detect(tier2[[i]], "  Organisation Name")) || (str_detect(tier2[[i]], "^ $")) || (str_detect(tier2[[i]], "^0$")) || (str_detect(tier2[[i]], "^$")) ){
tier2[[i]] <- NULL
}
}
if((str_detect(tier2[[i]], "  Organisation Name")) || (str_detect(tier2[[i]], "^ $")) || (str_detect(tier2[[i]], "^0$")) || str_detect(tier2[[i]], "^$")){
tier2[[i]] <- NULL
}
for (i in 1:length(tier2)){
if((str_detect(tier2[[i]], "  Organisation Name")) || (str_detect(tier2[[i]], "^ $")) || (str_detect(tier2[[i]], "^0$")) || str_detect(tier2[[i]], "^$")){
tier2[[i]] <- NULL
}
}
for (i in 1:length(tier2)){
(str_detect(tier2[[i]], "^$"))
}
for (i in 1:length(tier2)){
(str_detect(tier2[[i]], "^$"))
}
for (i in 1:length(tier2)){
(str_detect(tier2[[i]], "^$"))
}
View(tier2)
